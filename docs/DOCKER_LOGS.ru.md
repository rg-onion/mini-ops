# Просмотр логов Docker (SSE)

Функционал реализован с использованием Server-Sent Events (SSE) для обеспечения реального времени и минимальных задержек.

## Backend Архитектура

### Docker Service (`src/docker.rs`)
Функция `logs_stream` использует библиотеку `bollard` для подключения к Docker Socket.
- **Параметры**:
  - `since`: Unix timestamp для фильтрации старых логов.
  - `tail`: Количество строк для загрузки при инициализации (по умолчанию **1000** строк). Максимальное значение ограничено **10,000** строк.
- **Реализация**: Использует `futures_util::Stream` для асинхронной передачи логов по мере их появления.

### API Handler (`src/main.rs`)
Эндпоинт `/api/docker/containers/{id}/logs` принимает параметры через Query String:
- `since`: (Опционально) Фильтр по времени.
- `tail`: (Опционально) Ограничение количества строк. Валидируется на сервере (max 10,000).

Авторизация передается через HTTP заголовок:
- `Authorization: Bearer <AUTH_TOKEN>`

## Frontend Архитектура

### LogViewer Component (`frontend/src/components/LogViewer.tsx`)
Компонент управляет жизненным циклом SSE соединения и предоставляет интерфейс поиска/фильтрации.

#### Основные функции:
- **Поиск и Фильтрация**:
  - **Мгновенный поиск**: Поле ввода фильтрует загруженные логи "на лету" (case-insensitive).
  - **Быстрые фильтры**: Кнопки `ERROR`, `WARN`, `INFO` для быстрой диагностики проблем.
  - **Оптимизация**: Фильтрация выполняется на клиенте (JavaScript memory) без повторных запросов к API.
- **Управление историей**:
  - **Кнопки выбора**: `100`, `1k`, `All` (Max 10000), `15m`, `1h`, `24h`.
  - **Защита памяти**: В браузере хранится не более **10,000** последних строк, чтобы избежать зависания вкладки.
- **Интерфейс поиска**:
  - Поле поиска фокусируется на тексте, иконка лупы убрана для экономии места и предотвращения наложения.
  - Кнопка очистки (X) вынесена за пределы поля ввода.
- **Скачивание**:
  - Кнопка `Download` сохраняет текущее видимое содержимое (с учетом активного фильтра).
  - Если выделен текст, сохраняется только выделение.
- **Пауза/Продолжить**: Останавливает авто-прокрутку, но продолжает накапливать логи в буфере.

#### Интернационализация:
- Полная поддержка (EN/RU) через `frontend/src/locales/*.json`.
- Ключи: `containers.logs_control.*`.

## Безопасность и Производительность
- **Auth**: Доступ ограничен через `AUTH_TOKEN`, проверяется в `auth_middleware`.
- **DoS Protection**:
  - Backend принудительно ограничивает параметр `tail` до 10,000 строк.
  - Frontend обрезает массив логов при переполнении (FIFO).

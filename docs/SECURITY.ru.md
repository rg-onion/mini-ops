# Security & Alerting (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –û–ø–æ–≤–µ—â–µ–Ω–∏—è)

Mini-Ops –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞—É–¥–∏—Ç–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞.

## üõ°Ô∏è Security Audit

–ú–æ–¥—É–ª—å `SecurityAuditor` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### –ü—Ä–æ–≤–µ—Ä–∫–∏ (Checks)

1.  **SSH Root Login**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: —Ñ–∞–π–ª `/etc/ssh/sshd_config`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: `PermitRootLogin` –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `yes`.
    *   **–†–∏—Å–∫**: –†–∞–∑—Ä–µ—à–∞–µ—Ç –ø—Ä—è–º–æ–π –≤—Ö–æ–¥ `root` –ø–æ –ø–∞—Ä–æ–ª—é, —á—Ç–æ —É—è–∑–≤–∏–º–æ –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞.

2.  **Firewall (UFW)**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –Ω–∞–ª–∏—á–∏–µ UFW –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö:
        - `/usr/sbin/ufw`
        - `/usr/bin/ufw`
        - `/sbin/ufw`
        - `/bin/ufw`
    *   **–ó–∞–ø—É—Å–∫–∞–µ—Ç**: `ufw status` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    *   **PASS**: UFW –∞–∫—Ç–∏–≤–µ–Ω
    *   **FAIL**: UFW —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω
    *   **WARN**: UFW –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –ø—Ä–∞–≤)

3.  **Docker Socket**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ `/var/run/docker.sock`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: –ù–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤—Å–µ–º (`o+w`).
    *   **–†–∏—Å–∫**: –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–æ–∫–µ—Ç—É –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∞ root –Ω–∞ —Ö–æ—Å—Ç–µ.

4.  **Disk Encryption**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –Ω–∞–ª–∏—á–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤ —Ç–∏–ø–∞ `crypt` —á–µ—Ä–µ–∑ `lsblk`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: –ù–∞–ª–∏—á–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (LUKS).
    *   **–†–∏—Å–∫**: –§–∏–∑–∏—á–µ—Å–∫–∞—è –∫—Ä–∞–∂–∞ –¥–∏—Å–∫–æ–≤.

5.  **Fail2Ban Status**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞ `fail2ban` —á–µ—Ä–µ–∑ `systemctl`.
    *   **–†–∏—Å–∫**: –ë–µ–∑ Fail2Ban —Å–µ—Ä–≤–µ—Ä —É—è–∑–≤–∏–º –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –ø–∞—Ä–æ–ª–µ–π.

6.  **SSH Password Auth**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: —Ñ–∞–π–ª `/etc/ssh/sshd_config`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: `PasswordAuthentication` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `no`.
    *   **–†–∏—Å–∫**: –í—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–µ–Ω, —á–µ–º –ø–æ SSH –∫–ª—é—á–∞–º.

7.  **Listening Ports**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –æ—Ç–∫—Ä—ã—Ç—ã–µ TCP/UDP –ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ `ss -tulpn`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: –¢–æ–ª—å–∫–æ –æ–∂–∏–¥–∞–µ–º—ã–µ –ø–æ—Ä—Ç—ã (22, 80, 443, 3000) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã.
    *   **–†–∏—Å–∫**: –õ–∏—à–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏.

## üîí SSH Security & Alerts

Mini-Ops –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π. –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ [SSH_ALERTS.md](SSH_ALERTS.md).

## üîî Alerting (–û–ø–æ–≤–µ—â–µ–Ω–∏—è)

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑ –≤ 60 —Å–µ–∫—É–Ω–¥) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram.

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
*   **–ò–Ω—Ü–∏–¥–µ–Ω—Ç**: –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è —Å `PASS` –Ω–∞ `FAIL` -> –®–ª–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ üö®.
*   **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è —Å `FAIL` –Ω–∞ `PASS` -> –®–ª–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ‚úÖ.
*   **Anti-Spam**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —à–ª–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ **—Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞**.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram
–î–ª—è —Ä–∞–±–æ—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` –∑–∞–¥–∞–Ω—ã:
```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
TELEGRAM_CHAT_ID=–≤–∞—à_id
```

## üåê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (Deployment)

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π
–°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (`bootstrap_server.sh`) –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
1. **Reverse Proxy (Nginx)**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è Nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ø–æ—Ä—Ç–∞ `8090` (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `DEPLOY_NGINX_PORT`) –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
2. **–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–∏–≤—è–∑–∫–∞**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `mini-ops` —Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `127.0.0.1:3000`. –≠—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä—è–º–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ –æ–±—Ö–æ–¥ Nginx.
3. **–ë—Ä–∞–Ω–¥–º–∞—É—ç—Ä (UFW)**: –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç—É `3000` –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)
–°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —É–º–µ–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å `.env` —Ñ–∞–π–ª —Å –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –Ω–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä:
- –ï—Å–ª–∏ –≤ –∫–æ—Ä–Ω–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –µ—Å—Ç—å —Ñ–∞–π–ª `.env`, –æ–Ω –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ SCP –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ.
- –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ `.env` –Ω–µ—Ç, —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç `.env.example` –≤ –∫–∞—á–µ—Å—Ç–≤–µ —à–∞–±–ª–æ–Ω–∞, –ø–æ–∑–≤–æ–ª—è—è –ª–µ–≥–∫–æ –ø–µ—Ä–≤–∏—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ.
- –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–∫–µ–Ω—ã Telegram) –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤—ã —è–≤–Ω–æ –∑–∞–¥–∞–ª–∏ –∏—Ö –ª–æ–∫–∞–ª—å–Ω–æ (–≤ `.env` –∏–ª–∏ `.env.example`). –°–∫—Ä–∏–ø—Ç –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã ‚Äî –æ–Ω –ª–∏—à—å –¥–æ–ø–æ–ª–Ω—è–µ—Ç —Ñ–∞–π–ª –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Å–µ—Ç–µ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–Ω–∞–ø—Ä. `APP_HOST=127.0.0.1`), –µ—Å–ª–∏ –æ–Ω–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.

# Security & Alerting (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –û–ø–æ–≤–µ—â–µ–Ω–∏—è)

Mini-Ops –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞—É–¥–∏—Ç–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞.

## üõ°Ô∏è Security Audit

–ú–æ–¥—É–ª—å `SecurityAuditor` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### –ü—Ä–æ–≤–µ—Ä–∫–∏ (Checks)

1.  **SSH Root Login**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: —Ñ–∞–π–ª `/etc/ssh/sshd_config`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: `PermitRootLogin` –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `yes`.
    *   **–†–∏—Å–∫**: –†–∞–∑—Ä–µ—à–∞–µ—Ç –ø—Ä—è–º–æ–π –≤—Ö–æ–¥ `root` –ø–æ –ø–∞—Ä–æ–ª—é, —á—Ç–æ —É—è–∑–≤–∏–º–æ –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞.

2.  **Firewall (UFW)**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –Ω–∞–ª–∏—á–∏–µ UFW –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö:
        - `/usr/sbin/ufw`
        - `/usr/bin/ufw`
        - `/sbin/ufw`
        - `/bin/ufw`
    *   **–ó–∞–ø—É—Å–∫–∞–µ—Ç**: `ufw status` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    *   **PASS**: UFW –∞–∫—Ç–∏–≤–µ–Ω
    *   **FAIL**: UFW —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω
    *   **WARN**: UFW –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –ø—Ä–∞–≤)

3.  **Docker Socket**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ `/var/run/docker.sock`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: –ù–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤—Å–µ–º (`o+w`).
    *   **–†–∏—Å–∫**: –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–æ–∫–µ—Ç—É –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∞ root –Ω–∞ —Ö–æ—Å—Ç–µ.

4.  **Disk Encryption**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –Ω–∞–ª–∏—á–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤ —Ç–∏–ø–∞ `crypt` —á–µ—Ä–µ–∑ `lsblk`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: –ù–∞–ª–∏—á–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (LUKS).
    *   **–†–∏—Å–∫**: –§–∏–∑–∏—á–µ—Å–∫–∞—è –∫—Ä–∞–∂–∞ –¥–∏—Å–∫–æ–≤.

5.  **Fail2Ban Status**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞ `fail2ban` —á–µ—Ä–µ–∑ `systemctl`.
    *   **–†–∏—Å–∫**: –ë–µ–∑ Fail2Ban —Å–µ—Ä–≤–µ—Ä —É—è–∑–≤–∏–º –∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –ø–∞—Ä–æ–ª–µ–π.

6.  **SSH Password Auth**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: —Ñ–∞–π–ª `/etc/ssh/sshd_config`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: `PasswordAuthentication` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `no`.
    *   **–†–∏—Å–∫**: –í—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–µ–Ω, —á–µ–º –ø–æ SSH –∫–ª—é—á–∞–º.

7.  **Listening Ports**:
    *   **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç**: –æ—Ç–∫—Ä—ã—Ç—ã–µ TCP/UDP –ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ `ss -tulpn`.
    *   **–ü—Ä–∞–≤–∏–ª–æ**: –¢–æ–ª—å–∫–æ –æ–∂–∏–¥–∞–µ–º—ã–µ –ø–æ—Ä—Ç—ã (22, 80, 443, 3000) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã.
    *   **–†–∏—Å–∫**: –õ–∏—à–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏.

## üîí SSH Security & Alerts

Mini-Ops –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π. –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ [SSH_ALERTS.md](SSH_ALERTS.md).

## üîî Alerting (–û–ø–æ–≤–µ—â–µ–Ω–∏—è)

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑ –≤ 60 —Å–µ–∫—É–Ω–¥) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram.

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
*   **–ò–Ω—Ü–∏–¥–µ–Ω—Ç**: –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è —Å `PASS` –Ω–∞ `FAIL` -> –®–ª–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ üö®.
*   **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è —Å `FAIL` –Ω–∞ `PASS` -> –®–ª–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ‚úÖ.
*   **Anti-Spam**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —à–ª–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ **—Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞**.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram
–î–ª—è —Ä–∞–±–æ—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` –∑–∞–¥–∞–Ω—ã:
```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
TELEGRAM_CHAT_ID=–≤–∞—à_id
```

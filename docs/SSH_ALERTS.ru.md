# üîê SSH Alerts (–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—Ö–æ–¥–µ –ø–æ SSH)

Mini-Ops –≤–∫–ª—é—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è SSH-—Å–µ—Å—Å–∏–π –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –∫–∞–∂–¥–æ–º —É—Å–ø–µ—à–Ω–æ–º –≤—Ö–æ–¥–µ.

## ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º **PAM (Pluggable Authentication Modules)** –≤ Linux –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–æ–±—ã—Ç–∏–π –≤—Ö–æ–¥–∞.

1.  –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –≤—Ö–æ–¥–µ PAM –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç `/usr/local/bin/ssh-alert.sh`.
2.  –°–∫—Ä–∏–ø—Ç —á–∏—Ç–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏–∑ `/tmp/mini-ops-internal.token`.
3.  –°–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP POST –∑–∞–ø—Ä–æ—Å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π API Mini-Ops.
4.  Backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
    *   **Whitelist (–ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫)**: –ï—Å–ª–∏ IP –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è.
    *   **Rate Limiting**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ ‚Äî –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –æ–¥–Ω–æ–≥–æ IP.
5.  –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram.

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (Setup)

–ù–∞—Å—Ç—Ä–æ–π–∫—É –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ UI:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Security**.
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **SSH Setup** (–∏–ª–∏ **Enable SSH Alerts** –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–º –≤–∏–¥–µ).
3. –°–µ—Ä–≤–∏—Å –≤—ã–ø–æ–ª–Ω–∏—Ç:
    - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–∞ –≤ `/usr/local/bin/`.
    - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –≤ `/etc/pam.d/sshd`.

### –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
–ï—Å–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
journalctl -u mini-ops -f
# –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PAM
grep ssh-alert /var/log/syslog
```

## üõ°Ô∏è –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ (Trusted IPs)

–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è SSH –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å "–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ IP". –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å —ç—Ç–∏—Ö –∞–¥—Ä–µ—Å–æ–≤ –±—É–¥—É—Ç:
- –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ –∏—Å—Ç–æ—Ä–∏—é (Log).
- **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è** —Å–∏—Å—Ç–µ–º–æ–π –æ–ø–æ–≤–µ—â–µ–Ω–∏—è Telegram (—á—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü—É –ø—Ä–∏ –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—Ö–æ–¥–∞—Ö).

## üìä –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤

–†–∞–∑–¥–µ–ª **SSH Security** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞, –≤–∫–ª—é—á–∞—è:
- –í—Ä–µ–º—è –∏ –¥–∞—Ç—É.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`root`, `admin` –∏ —Ç.–¥.).
- IP –∞–¥—Ä–µ—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞.
- –°—Ç–∞—Ç—É—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–ª–∏ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–æ).

## ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–æ–∫–µ–Ω (`internal_token`) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º (UUID v4) –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ Mini-Ops. –û–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ `/tmp/mini-ops-internal.token` —Å –ø—Ä–∞–≤–∞–º–∏ `600` (—á—Ç–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è root). –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è –≤—Ö–æ–¥–∞ –≤ API.
